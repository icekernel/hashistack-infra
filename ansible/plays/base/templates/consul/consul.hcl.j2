datacenter = "{{ CONSUL_DATACENTER }}"
encrypt = "{{ CONSUL_KEY }}"
data_dir = "/opt/consul"

advertise_addr = "{{ '{{' }} GetPrivateInterfaces | include \"network\" \"10.0.0.0/8\" | attr \"address\" {{ '}}' }}"

recursors = [ "1.1.1.1", "8.8.8.8" ]
verify_incoming = true
verify_outgoing = true
verify_server_hostname = true

ca_file = "/etc/consul.d/{{ ENVIRONMENT}}-consul-agent-ca.pem"

retry_join = ["provider=aws tag_key=ConsulServer tag_value={{ ENVIRONMENT }}"]

acl {
  enabled = true
  default_policy = "deny"
  enable_token_persistence = true
}

connect {
  enabled = true
}

performance {
  raft_multiplier = 1
}

# telemetry {}
# configure this https://learn.hashicorp.com/tutorials/consul/monitor-datacenter-health
